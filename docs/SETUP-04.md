# Supabaseã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã¨å°å…¥

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€Flutter SNS Appã«Supabaseã‚’å°å…¥ã—ã€ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’Supabaseã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜ã™ã‚‹æ‰‹é †ã‚’èª¬æ˜ã—ã¾ã™ã€‚

## ğŸ“‹ ç›®æ¬¡

1. [Supabaseã¨ã¯](#supabaseã¨ã¯)
2. [Supabaseãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ](#supabaseãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ)
3. [ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä½œæˆ](#ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä½œæˆ)
4. [ç’°å¢ƒå¤‰æ•°ã®è¨­å®š](#ç’°å¢ƒå¤‰æ•°ã®è¨­å®š)
5. [ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«](#ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«)
6. [å‹•ä½œç¢ºèª](#å‹•ä½œç¢ºèª)
7. [ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](#ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°)

---

## Supabaseã¨ã¯

Supabaseã¯ã€Firebaseä»£æ›¿ã®ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹BaaSï¼ˆBackend as a Serviceï¼‰ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã™ã€‚
PostgreSQLãƒ™ãƒ¼ã‚¹ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã€èªè¨¼ã€ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸãªã©ã®æ©Ÿèƒ½ã‚’æä¾›ã—ã¾ã™ã€‚

### ä¸»ãªç‰¹å¾´

- PostgreSQLãƒ™ãƒ¼ã‚¹ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ‡ãƒ¼ã‚¿åŒæœŸ
- ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼æ©Ÿèƒ½
- ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸æ©Ÿèƒ½
- ç„¡æ–™ãƒ—ãƒ©ãƒ³ã‚ã‚Š

---

## Supabaseãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ

### 1. Supabaseã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ä½œæˆ

1. [Supabaseå…¬å¼ã‚µã‚¤ãƒˆ](https://supabase.com/)ã«ã‚¢ã‚¯ã‚»ã‚¹
2. å³ä¸Šã®ã€ŒStart your projectã€ã¾ãŸã¯ã€ŒSign upã€ã‚’ã‚¯ãƒªãƒƒã‚¯
3. GitHubã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—ï¼ˆæ¨å¥¨ï¼‰ã¾ãŸã¯ã€ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã§ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—

### 2. æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ

1. ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«ãƒ­ã‚°ã‚¤ãƒ³å¾Œã€ã€ŒNew Projectã€ã‚’ã‚¯ãƒªãƒƒã‚¯
2. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæƒ…å ±ã‚’å…¥åŠ›:
   ```
   Name: flutter-sns-app (ä»»æ„ã®åå‰)
   Database Password: å¼·åŠ›ãªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ç”Ÿæˆãƒ»ä¿å­˜
   Region: Northeast Asia (Tokyo) (æ—¥æœ¬ã®å ´åˆ)
   Pricing Plan: Free (é–‹ç™ºç”¨)
   ```
3. ã€ŒCreate new projectã€ã‚’ã‚¯ãƒªãƒƒã‚¯
4. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆå®Œäº†ã¾ã§1-2åˆ†å¾…æ©Ÿ

### 3. APIã‚­ãƒ¼ã®ç¢ºèª

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒä½œæˆã•ã‚ŒãŸã‚‰ã€APIã‚­ãƒ¼ã‚’ç¢ºèªã—ã¾ã™:

1. å·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼ã®ã€ŒSettingsã€(âš™ï¸)ã‚’ã‚¯ãƒªãƒƒã‚¯
2. ã€ŒAPIã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
3. ä»¥ä¸‹ã®æƒ…å ±ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ä¿å­˜:
   - **Project URL** (ä¾‹: `https://xxxxxxxxxxxxx.supabase.co`)
   - **anon public** (å…¬é–‹API ã‚­ãƒ¼)

> âš ï¸ **é‡è¦**: `service_role` ã‚­ãƒ¼ã¯ä½¿ç”¨ã—ãªã„ã§ãã ã•ã„ã€‚ã“ã‚Œã¯å®Œå…¨ãªç®¡ç†è€…æ¨©é™ã‚’æŒã¤ãŸã‚ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§ã¯ä½¿ç”¨ã§ãã¾ã›ã‚“ã€‚

---

## ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä½œæˆ

ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã™ã‚‹ãŸã‚ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚

### 1. SQL Editorã§ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆ

1. å·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼ã®ã€ŒSQL Editorã€ã‚’ã‚¯ãƒªãƒƒã‚¯
2. ã€ŒNew queryã€ã‚’ã‚¯ãƒªãƒƒã‚¯
3. ä»¥ä¸‹ã®SQLã‚’å…¥åŠ›:

```sql
-- ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä½œæˆ
CREATE TABLE counters (
  id INTEGER PRIMARY KEY,
  value INTEGER NOT NULL DEFAULT 0,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc', NOW()),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT TIMEZONE('utc', NOW())
);

-- åˆæœŸãƒ‡ãƒ¼ã‚¿ã®æŒ¿å…¥
INSERT INTO counters (id, value) VALUES (1, 0);

-- æ›´æ–°æ™‚ã« updated_at ã‚’è‡ªå‹•æ›´æ–°ã™ã‚‹ãƒˆãƒªã‚¬ãƒ¼
CREATE OR REPLACE FUNCTION update_updated_at_column()
RETURNS TRIGGER AS $$
BEGIN
  NEW.updated_at = TIMEZONE('utc', NOW());
  RETURN NEW;
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER update_counters_updated_at
  BEFORE UPDATE ON counters
  FOR EACH ROW
  EXECUTE FUNCTION update_updated_at_column();
```

4. ã€ŒRunã€(ã¾ãŸã¯ Ctrl+Enter)ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦å®Ÿè¡Œ
5. ã€ŒSuccess. No rows returnedã€ã¨è¡¨ç¤ºã•ã‚Œã‚Œã°æˆåŠŸ

### 2. ãƒ†ãƒ¼ãƒ–ãƒ«ã®ç¢ºèª

1. å·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼ã®ã€ŒTable Editorã€ã‚’ã‚¯ãƒªãƒƒã‚¯
2. `counters` ãƒ†ãƒ¼ãƒ–ãƒ«ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
3. ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’é–‹ã„ã¦ã€`id=1, value=0` ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒå­˜åœ¨ã™ã‚‹ã“ã¨ã‚’ç¢ºèª

### 3. Row Level Security (RLS)ã®è¨­å®š

é–‹ç™ºåˆæœŸæ®µéšã§ã¯ã€RLSã‚’ç„¡åŠ¹åŒ–ã™ã‚‹ã‹ã€å…¨ã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å¯ã—ã¾ã™:

#### æ–¹æ³•1: RLSã‚’ç„¡åŠ¹åŒ–ï¼ˆé–‹ç™ºç’°å¢ƒã®ã¿æ¨å¥¨ï¼‰

```sql
ALTER TABLE counters DISABLE ROW LEVEL SECURITY;
```

#### æ–¹æ³•2: å…¨ã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å¯ï¼ˆæ¨å¥¨ï¼‰

```sql
-- RLSã‚’æœ‰åŠ¹åŒ–
ALTER TABLE counters ENABLE ROW LEVEL SECURITY;

-- ã™ã¹ã¦ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«èª­ã¿å–ã‚Šæ¨©é™ã‚’ä»˜ä¸
CREATE POLICY "Allow public read access"
  ON counters FOR SELECT
  TO public
  USING (true);

-- ã™ã¹ã¦ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«æ›´æ–°æ¨©é™ã‚’ä»˜ä¸
CREATE POLICY "Allow public update access"
  ON counters FOR UPDATE
  TO public
  USING (true)
  WITH CHECK (true);

-- ã™ã¹ã¦ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«æŒ¿å…¥æ¨©é™ã‚’ä»˜ä¸
CREATE POLICY "Allow public insert access"
  ON counters FOR INSERT
  TO public
  WITH CHECK (true);
```

> ğŸ’¡ **æœ¬ç•ªç’°å¢ƒã§ã¯**: èªè¨¼ã•ã‚ŒãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã¿ãŒã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ã€é©åˆ‡ãªRLSãƒãƒªã‚·ãƒ¼ã‚’è¨­å®šã—ã¦ãã ã•ã„ã€‚

---

## ç’°å¢ƒå¤‰æ•°ã®è¨­å®š

### 1. .envãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã« `.env` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™:

```bash
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆ (flutter_sns_app/) ã§å®Ÿè¡Œ
# æ—¢ã« .env.example ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã™ã‚‹ãŸã‚ã€ã‚³ãƒ”ãƒ¼ã—ã¦ä½¿ç”¨
cp .env.example .env
```

Windows ã®å ´åˆ:
```bash
copy .env.example .env
```

### 2. .envãƒ•ã‚¡ã‚¤ãƒ«ã®ç·¨é›†

`.env` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ãã€Supabaseã®æƒ…å ±ã‚’å…¥åŠ›ã—ã¾ã™:

```env
# Supabase Configuration
SUPABASE_URL=https://xxxxxxxxxxxxx.supabase.co
SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

- `SUPABASE_URL`: Supabaseãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã® Settings > API > Project URL
- `SUPABASE_ANON_KEY`: Supabaseãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã® Settings > API > anon public

### 3. .gitignoreã®ç¢ºèª

`.env` ãƒ•ã‚¡ã‚¤ãƒ«ãŒ `.gitignore` ã«å«ã¾ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ï¼ˆæ—¢ã«è¨­å®šæ¸ˆã¿ï¼‰:

```gitignore
# Environment variables
.env
.env.local
.env.*.local
```

> âš ï¸ **é‡è¦**: `.env` ãƒ•ã‚¡ã‚¤ãƒ«ã¯çµ¶å¯¾ã«Gitã«ã‚³ãƒŸãƒƒãƒˆã—ãªã„ã§ãã ã•ã„ã€‚APIã‚­ãƒ¼ãŒæ¼æ´©ã™ã‚‹ã¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒªã‚¹ã‚¯ã«ãªã‚Šã¾ã™ã€‚

---

## ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

### 1. ä¾å­˜é–¢ä¿‚ã®ç¢ºèª

`pubspec.yaml` ã«ä»¥ä¸‹ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒè¿½åŠ ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ï¼ˆæ—¢ã«è¨­å®šæ¸ˆã¿ï¼‰:

```yaml
dependencies:
  flutter:
    sdk: flutter

  cupertino_icons: ^1.0.8

  # Supabase client for Flutter
  supabase_flutter: ^2.9.3

  # Environment variables
  flutter_dotenv: ^5.2.1

flutter:
  uses-material-design: true

  # .envãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ã‚»ãƒƒãƒˆã¨ã—ã¦è¿½åŠ 
  assets:
    - .env
```

### 2. ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™:

```bash
flutter pub get
```

å®Ÿè¡Œçµæœ:
```
Running "flutter pub get" in flutter_sns_app...
Resolving dependencies...
+ supabase_flutter 2.9.3
+ flutter_dotenv 5.2.1
...
Got dependencies!
```

---

## å‹•ä½œç¢ºèª

### 1. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®èµ·å‹•

```bash
flutter run
```

ã¾ãŸã¯ã€VS Codeã®ãƒ‡ãƒãƒƒã‚°æ©Ÿèƒ½ï¼ˆF5ï¼‰ã§ã‚¢ãƒ—ãƒªã‚’èµ·å‹•ã—ã¾ã™ã€‚

### 2. ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼æ©Ÿèƒ½ã®ãƒ†ã‚¹ãƒˆ

1. ã‚¢ãƒ—ãƒªãŒèµ·å‹•ã—ã€ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹
2. ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿å¾Œã€ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼å€¤ï¼ˆåˆæœŸå€¤: 0ï¼‰ãŒè¡¨ç¤ºã•ã‚Œã‚‹
3. ã€Œ+ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã‚’å¢—ã‚„ã™
4. ã‚¢ãƒ—ãƒªã‚’å®Œå…¨ã«çµ‚äº†ï¼ˆå†èµ·å‹•ï¼‰ã™ã‚‹
5. å†åº¦ã‚¢ãƒ—ãƒªã‚’èµ·å‹•ã—ã€ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼å€¤ãŒä¿æŒã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª

### 3. Supabaseãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ã®ç¢ºèª

1. Supabaseã®ã€ŒTable Editorã€ã‚’é–‹ã
2. `counters` ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’é¸æŠ
3. `value` ã‚«ãƒ©ãƒ ãŒã€ã‚¢ãƒ—ãƒªã§å¢—ã‚„ã—ãŸå€¤ã¨ä¸€è‡´ã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª
4. `updated_at` ãŒæœ€æ–°ã®æ—¥æ™‚ã«ãªã£ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª

---

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚¨ãƒ©ãƒ¼: "Unable to load asset: .env"

**åŸå› **: `.env` ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ãªã„ã‹ã€`pubspec.yaml` ã®assetsã«è¿½åŠ ã•ã‚Œã¦ã„ãªã„

**è§£æ±ºæ–¹æ³•**:
1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã« `.env` ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã™ã‚‹ã‹ç¢ºèª
2. `pubspec.yaml` ã® `assets` ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã« `- .env` ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
3. `flutter pub get` ã‚’å†å®Ÿè¡Œ
4. ã‚¢ãƒ—ãƒªã‚’å†èµ·å‹•

### ã‚¨ãƒ©ãƒ¼: "Invalid API key"

**åŸå› **: `.env` ãƒ•ã‚¡ã‚¤ãƒ«ã®APIã‚­ãƒ¼ãŒé–“é•ã£ã¦ã„ã‚‹

**è§£æ±ºæ–¹æ³•**:
1. Supabaseãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ Settings > API ã‚’é–‹ã
2. Project URL ã¨ anon public ã‚­ãƒ¼ã‚’å†åº¦ã‚³ãƒ”ãƒ¼
3. `.env` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ›´æ–°
4. ã‚¢ãƒ—ãƒªã‚’å®Œå…¨ã«å†èµ·å‹•ï¼ˆãƒ›ãƒƒãƒˆãƒªãƒ­ãƒ¼ãƒ‰ã§ã¯åæ˜ ã•ã‚Œã¾ã›ã‚“ï¼‰

### ã‚¨ãƒ©ãƒ¼: "Row Level Security policy violation"

**åŸå› **: RLSãŒæœ‰åŠ¹ã ãŒã€é©åˆ‡ãªãƒãƒªã‚·ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ãªã„

**è§£æ±ºæ–¹æ³•**:
1. Supabaseã® SQL Editor ã‚’é–‹ã
2. [Row Level Security (RLS)ã®è¨­å®š](#3-row-level-security-rlsã®è¨­å®š)ã®SQLã‚’å®Ÿè¡Œ
3. ã¾ãŸã¯ã€é–‹ç™ºç’°å¢ƒã§ã¯ `ALTER TABLE counters DISABLE ROW LEVEL SECURITY;` ã‚’å®Ÿè¡Œ

### ã‚¨ãƒ©ãƒ¼: "relation 'counters' does not exist"

**åŸå› **: `counters` ãƒ†ãƒ¼ãƒ–ãƒ«ãŒä½œæˆã•ã‚Œã¦ã„ãªã„

**è§£æ±ºæ–¹æ³•**:
1. Supabaseã® SQL Editor ã‚’é–‹ã
2. [ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä½œæˆ](#ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä½œæˆ)ã®SQLã‚’å®Ÿè¡Œ

### ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼å€¤ãŒä¿å­˜ã•ã‚Œãªã„

**åŸå› **: ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ã¾ãŸã¯Supabaseã®æ¥ç¶šå•é¡Œ

**è§£æ±ºæ–¹æ³•**:
1. ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šã‚’ç¢ºèª
2. Supabaseãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‹ç¢ºèª
3. `.env` ã® `SUPABASE_URL` ãŒæ­£ã—ã„ã‹ç¢ºèª
4. ã‚¢ãƒ—ãƒªã®ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆSnackBarï¼‰ã‚’ç¢ºèª

### ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãŒçµ‚ã‚ã‚‰ãªã„

**åŸå› **: Supabaseã¸ã®æ¥ç¶šãŒã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã—ã¦ã„ã‚‹

**è§£æ±ºæ–¹æ³•**:
1. ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ã‚„ãƒ—ãƒ­ã‚­ã‚·è¨­å®šã‚’ç¢ºèª
2. Supabaseã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒšãƒ¼ã‚¸ï¼ˆhttps://status.supabase.com/ï¼‰ã‚’ç¢ºèª
3. ãƒ‡ãƒãƒƒã‚°ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç¢ºèª
4. `lib/main.dart` ã® `_loadCounter()` ãƒ¡ã‚½ãƒƒãƒ‰ã« `print(e)` ã‚’è¿½åŠ ã—ã¦ã‚¨ãƒ©ãƒ¼è©³ç´°ã‚’ç¢ºèª

---

## ğŸ“ å®Ÿè£…ã®è©³ç´°

### ã‚³ãƒ¼ãƒ‰ã®èª¬æ˜

`lib/main.dart` ã§ã®Supabaseçµ±åˆã®ä¸»è¦éƒ¨åˆ†:

#### 1. åˆæœŸåŒ– (mainé–¢æ•°)

```dart
Future<void> main() async {
  WidgetsFlutterBinding.ensureInitialized();

  // .envãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ç’°å¢ƒå¤‰æ•°ã‚’èª­ã¿è¾¼ã¿
  await dotenv.load(fileName: '.env');

  // Supabaseã®åˆæœŸåŒ–
  await Supabase.initialize(
    url: dotenv.env['SUPABASE_URL']!,
    anonKey: dotenv.env['SUPABASE_ANON_KEY']!,
  );

  runApp(const MyApp());
}
```

#### 2. ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ (_loadCounter)

```dart
Future<void> _loadCounter() async {
  try {
    // Supabaseã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
    final response = await supabase
        .from('counters')
        .select('value')
        .eq('id', 1)
        .maybeSingle();

    if (response != null) {
      // ãƒ‡ãƒ¼ã‚¿ãŒå­˜åœ¨ã™ã‚‹å ´åˆã€å€¤ã‚’è¨­å®š
      setState(() {
        _counter = response['value'] as int;
        _isLoading = false;
      });
    } else {
      // ãƒ‡ãƒ¼ã‚¿ãŒå­˜åœ¨ã—ãªã„å ´åˆã€åˆæœŸå€¤ã‚’æŒ¿å…¥
      await supabase.from('counters').insert({'id': 1, 'value': 0});
      setState(() {
        _counter = 0;
        _isLoading = false;
      });
    }
  } catch (e) {
    // ã‚¨ãƒ©ãƒ¼å‡¦ç†
    ScaffoldMessenger.of(context).showSnackBar(
      SnackBar(content: Text('Error loading counter: $e')),
    );
  }
}
```

#### 3. ãƒ‡ãƒ¼ã‚¿æ›´æ–° (_incrementCounter)

```dart
Future<void> _incrementCounter() async {
  final newValue = _counter + 1;

  // UIã‚’å³åº§ã«æ›´æ–°ï¼ˆæ¥½è¦³çš„æ›´æ–°ï¼‰
  setState(() {
    _counter = newValue;
  });

  try {
    // Supabaseã«ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜
    await supabase
        .from('counters')
        .update({'value': newValue})
        .eq('id', 1);
  } catch (e) {
    // ã‚¨ãƒ©ãƒ¼å‡¦ç†
    ScaffoldMessenger.of(context).showSnackBar(
      SnackBar(content: Text('Error saving counter: $e')),
    );
  }
}
```

---

## ğŸ”— é–¢é€£ãƒªãƒ³ã‚¯

- [Supabaseå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://supabase.com/docs)
- [Supabase Flutter ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ](https://supabase.com/docs/guides/getting-started/quickstarts/flutter)
- [flutter_dotenv ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸](https://pub.dev/packages/flutter_dotenv)
- [supabase_flutter ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸](https://pub.dev/packages/supabase_flutter)

---

## ğŸ“Š æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

Supabaseã®å°å…¥ãŒå®Œäº†ã—ãŸã‚‰ã€ä»¥ä¸‹ã®æ©Ÿèƒ½ã‚’è¿½åŠ ã§ãã¾ã™:

- [ ] ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼æ©Ÿèƒ½ã®å®Ÿè£…
- [ ] ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ‡ãƒ¼ã‚¿åŒæœŸ
- [ ] è¤‡æ•°ãƒ¦ãƒ¼ã‚¶ãƒ¼é–“ã§ã®ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼å…±æœ‰
- [ ] ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½ï¼ˆSupabase Storageï¼‰
- [ ] ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç®¡ç†æ©Ÿèƒ½

---

**æœ€çµ‚æ›´æ–°**: 2025-10-10
